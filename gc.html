<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
<meta name="description" content="description"/>
<meta name="keywords" content="keywords"/> 
<meta name="author" content="Arcsin, www.arcsin.se"/> 
<link rel="stylesheet" type="text/css" href="default.css"/>
<title>Google Charts</title>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

</head>
<body>
<div class="main">
	<div class="container">
		<div class="gfx"><a href="index.html"><span></span></a></div>
		<div class="menu">
			<a href="demo.html"><span>Home</span></a>
			<a href="js.html"><span>Javascript To Canvas</span></a>
			<a href="gc.html"><span>Google Charts</span></a>	           
            <a href="index.html"><span>noe</span></a>
            <a href="index.html"><span>noe</span></a>
            <a href="index.html"><span>noe</span></a>		
			<a href="omOss.html" id="last"><span>Om Oss</span></a>
		</div>
		<div class="content">
			<div class="item">
				<h1>Google Charts</h1>
<form method = "POST" action="/" id="submitForm">
Sensor: <br><select name="selectSensor" id="selectSensor">
</select>
<br>Minutes: <br><input id="linesToGet" type="text" value="1440" size = "6" />
<input id="btnSet" type="button" value="Submit" />
</form>

    <script type="text/javascript">
    
    google.load('visualization', '1', {'packages':['corechart']});

    $("document").ready(function() {

	$('#btnSet').bind('click', drawChart);
	getSensorNames();
    });

    // Grab the sensornames and populate the <select> element
    function getSensorNames() {
        $.ajax({
          url: "scripts/getsensors.py",
          type: "POST",
          dataType:"json",
          success: function(response) {
	     $(response).each(function() {
	       var option = $('<option />');
               option.attr('value', this).text(this.slice(0,-4)); // cuts off .csv
               $('#selectSensor').append(option);
             });
	  }
        });
    }
    // Send the name of the selected sensor and the amt of lines we want returned, then create a new visualization object and draw it.
    function drawChart() {
      var jsonData = $.ajax({
          url: "scripts/ajaxpost.py",
          dataType:"json",
	  type: "POST",
	  data: {'linesToGet' : $("#linesToGet").val(), 'sensor' : $("#selectSensor").val() },
          async: false
          }).responseText;

        var data = new google.visualization.DataTable(jsonData);

	// All options for LineChart go here.
        var options = {
          title: $("#selectSensor").val().slice(0,-4), // cuts off .csv
          hAxis: { 
            format: 'dMMM HH:ms' 
    	  }  
        };

        var chart = new google.visualization.LineChart(document.getElementById('visualization'));
        chart.draw(data, options);
    }
   
  </script>
	<div id="visualization" style="width: 1000px; height: 400px;"></div>
	</div>
	</div>
	<div class="footer">&copy; 2012 Gruppe 4</div>
	</div>	
</div>
</body>
</html>
